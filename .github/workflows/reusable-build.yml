---
name: Reusable build

permissions: {}

on:
  workflow_call:

env:
  FORCE_COLOR: 1

jobs:
  build:
    name: Build distribution ðŸ“¦
    runs-on: ubuntu-24.04
    timeout-minutes: 5

    steps:
    - uses: actions/checkout@8e8c483db84b4bee98b60c0593521ed34d9990e8  # v6.0.1
      with:
        persist-credentials: false
    - name: Install uv
      # yamllint disable-line rule:line-length
      uses: astral-sh/setup-uv@61cb8a9741eeb8a550a1b8544337180c0fc8476b  # v7.2.0
      with:
        # yamllint disable-line rule:line-length
        enable-cache: | # zizmor: ignore[cache-poisoning] cache is disabled when publishing to prevent poisoning
          ${{ github.ref_type == 'tag' && 'false' || 'auto' }}
    - name: Build distribution ðŸ“¦
      run: uv build
    - name: Check distribution ðŸ“¦
      run: uvx twine check --strict dist/*
    - name: Upload distribution ðŸ“¦
      # yamllint disable-line rule:line-length
      uses: actions/upload-artifact@b7c566a772e6b6bfb58ed0dc250532a479d7789f  # v6.0.0
      with:
        name: python-package-distributions
        path: dist/
