language: python

python:
    - 3.5
    - 3.6

matrix:
  include:
  - python: 3.6
    env: EXTRA="awscli"
  - python: 3.6
    env: EXTRA="boto3"

install:
    - pip install -U setuptools
    - if [[ -v EXTRA ]]; then pip install pipdeptree; fi
    - if ! [[ -v EXTRA ]]; then pip install -r requirements-dev.txt; fi
    - pip install codecov
    - pip freeze

script:
    - if [[ -v EXTRA ]]; then pip install -U .[$EXTRA] && pipdeptree --warn fail; fi
    - if ! [[ -v EXTRA ]]; then make flake mototest; fi
after_success:
    codecov
deploy:
    provider: pypi
    user: thehesiod
    distributions: "sdist bdist_wheel"
    password:
        secure: axy94wnXE7rMOlmRIoEaHLHhBGqeAVEbZnh7DvFbsVMO4JsIPXav1U44PLjXfIsEIo2cUuaE7+aEO4pN8o2OTGPiNm4X9uzxxj8qGOmo3D0NDUhaxfH3nhLHbDxNlheWt2m3ppExcjO7fiItrMzVC+H+/WGVzicg2YK/oKYrjHkgmclYUFL/IS4fZJMs9SsXfjQYBjHElTLqVeE1FsYZaFwEGaekRrGIJI07aLScggd/xsQJ8IrI3fKmBMkzXdh5AsSPcxPwCemW1S71W6DDVR8C8oroJw8kPmL0HmM+tBGVCiimmVBgkGBzWzD8wSJ+sw8RMApFr19jLfv+bHuy+T8oGjAwFAVimEm4P8bIw7Ti0oKzg1NuuPa8rVIeHNO5FeQIVcYZvtN00fyPf01Ke1IokBqecvB04OW0ko8/dbfjCaNsdP58WHsr3nExC2VBW+Qwcs4MljCu9vhN9320v/AN+bij5CU2pQ/+fQfqHANacInOntWqYpBCnGPrkV03/xzueEBUyops+e5EmjZwmLTWYFqoMfmd/UDcf04XDvjZM1tiQnlhoGhF8MiQs566X+47QvuTJ8ayvmM9t7X5TsJLbSiIpf0EbbTXQZefZxrP1xXpNMANPldimTIuS50qAtczQx2tvLSMNqkoMJFnKsqXrPBqkTVpyYWWAD0z7iI=
    on:
        tags: true
        repo: aio-libs/aiobotocore
        all_branches: true
        python: 3.5

cache: pip
